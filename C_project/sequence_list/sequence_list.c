#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<math.h>

#define OK 1
#define ERROR 0
#define OVERFIOW -1
#define MAXSIZE 10000		// ??????????????

typedef int Status;

typedef struct {		// ??????????
	char no[20];		// ??? ISBN
	char name[50];		// ???????
	double price;		// ?????
}Book;

typedef struct {
	Book *elem;			// ??????????
	int length;			// ??????????????
} SqList;

Status InitList(SqList *L, int Length) {			
	L->elem = (Book*)malloc(Length * sizeof(Book));	// ????????????????????
	if (!L->elem) exit(OVERFIOW);					// ?????????? ???
	L->length = 0;									// ?????? 0 
	return OK;
}

Status GetElem(SqList L, int i, Book *e) {
	if (i<1 || i>L.length) return ERROR;		// ???i???????????????????ERROR
	*e = L.elem[i - 1];							// elem[i-1] ???????i?????????
	return OK;
}

int LocateElem(SqList L, Book e) {					// ?????? L ???????e???????????????????;??????????0
	for (int i = 0; i < L.length; i++)
		if (CompareSL(L.elem[i],e)) return i + 1;	// ??????????????????? i+1
	return 0;										// ????????????0
}

Status ListInsert(SqList *L, int i, Book e) {		// ??????L???i????ò?????????e??i??????????1<=i<=L.length+1
	if (i<i || i>L->length + 1) return ERROR;		// i ??????
	if (L->length == MAXSIZE) return ERROR;			// ????????????
	for (int j = L->length - 1; j >= i - 1; j--)	
		L->elem[j + 1] = L->elem[j];				// ??????ü???????????
	L->elem[i - 1] = e;								// ???????e???????i?????
	++L->length;									// ????1
	return OK;
}

Status ListDelete(SqList *L, int i) {				// ?????????????i?????
	if (i<1 || i>L->length + 1) return ERROR;		// i ??????
	for (int j = i; j <= L->length - 1; j++)
		L->elem[j - 1] = L->elem[j];				// ??????ü???????????
	printf_s("****************%d\n", L->length);
	--L->length;
	printf_s("****************%d\n", L->length);
	return OK;
}

Status CompareSL(Book a, Book b) {			// ?????????? Book ???????????????
	if (!strcmp(a.no,b.no) && !strcmp(a.name,b.name) && fabs(a.price - b.price) < 0.001)
		return OK;
	else
		return ERROR;
}

main() {
	// ?????
	SqList List;
	InitList(&List, MAXSIZE);
	printf_s("*******?????********");
	printf_s("%d\n", List.length);

	// ????
	Book first;
	first.price = 789.4;
	strcpy_s(first.name, sizeof("??????"), "??????");
	strcpy_s(first.no, sizeof("1961310317"), "1961310317");
	ListInsert(&List, 1, first);
	printf_s("*********????********\n");
	printf_s("%d\n", LocateElem(List, first));

	// ??
	Book find;
	first.price = 456.21;
	strcpy_s(first.name, sizeof("??????"), "??????");
	strcpy_s(first.no, sizeof("1961310319"), "1961310319");
	ListInsert(&List, 1, first);

	GetElem(List, 1, &find);
	printf_s("*********??**********");
	printf_s("%s\n", find.name);
	printf_s("%f\n", find.price);

	// ????
	int ans = LocateElem(List, find);
	printf_s("********????*******\n");
	printf_s("%d\n", ans);

	// ???
	printf_s("*********???********\n");
	printf_s("%d\n", List.length);
	ListDelete(&List, 1);
	printf_s("%d\n", LocateElem(List, first));
	printf_s("%d\n", List.length);

	free(List.elem);
}